<!DOCTYPE HTML>
<html>
<head>
<title>One Piece eps</title>
<link rel="shortcut icon" href="icons/favicon.ico">
<style type="text/css">
	
	body {
		display: flex;
		flex-wrap: wrap;
		justify-content: center;
		font-family: Arial;
		background-color: lightblue;
	}
	p {
		color: white;
		padding: 0;
		margin: 0;
	}

	.iconsClass {
		/*gjer at du ikkje kan dragge bildene i forskjellige browsers*/
		user-drag: none; 
		user-select: none;
		-moz-user-select: none;
		-webkit-user-drag: none;
		-webkit-user-select: none;
		-ms-user-select: none; 
	}


	#headerBildeOgTextFelt {
		display: flex; /*flex, gjer bl.a. at alle headerBoxes he lik height*/
		z-index: 3; /* layerer headeren oppenfor epsOgWeekTabell */
		top: 0px;
		position: absolute;
		height: auto;
		width: 100%;
		background-color: #e01d1d; /*mørk rød*/
		text-align: center; /*sentrerer innholdet i headerBoxes*/
		justify-content: center; /*setter headerBoxes mot midten*/
	}
	.headerBoxes {
		display:inline-block;
	}



	#headerTextStaysAtTop {
		z-index: 2; /* gjemmer denne bak headerBildeOgTextFeltet, så den bare kommer frem når en har scrolla forbi bildene. fortsatt over epsOgWeekTabell*/
		top: 0px;
		width: 100%;
		height: 70px;
		background-color: #e01d1d; /*mørk rød*/
		text-align: center;
		position: fixed; /* den vil alltid ha posisjon top 0 */
	}

	#wallpaperDiv {
		z-index: 0; /*bak epsOgWeekTabell igjen*/
		width: 1080px;
		height: 720px;
		position: fixed; /*gjer at bildet blir stille selv om en scroller*/
	}
	#wallpaperImage { /*bildets id*/
		/*gjer at du ikkje kan dragge bakgrunnsbildet i forskjellige browsers*/
		user-drag: none; 
		user-select: none;
		-moz-user-select: none;
		-webkit-user-drag: none;
		-webkit-user-select: none;
		-ms-user-select: none; 
	}




	#epsOgWeekTabell {
		z-index: 1; /* legger dette bak headeren*/
		top: 160px; /* så det begynner rett under headeren, ikkje noge dekka for */
		position: relative;
		width: 500px;
		height: auto;
		background: rgba(173, 216, 230, 0.5); /*setter bkg farge, og gjer at bare den blir gjennomsiktig, ikkje teksten*/ 
		font-size: 16px; /* keep denne for pc, skal vær større på mobil */
	}

	#epsOgWeekTabell > table{
		border-collapse: collapse;
	}
	#epsOgWeekTabell th, #epsOgWeekTabell td {
		text-align: center; 
		border: 1px solid darkblue;
		margin: 0px;
		padding: 10px;
	}
	#epsOgWeekTabell tr:hover {
		background-color: #f5f5f5;
	}

	#epsOgWeekTabell th { /*gir 3d headeren en outline*/ 
		font-weight: bold;
		color: #fff;
		text-shadow: #000 0px 0px 1px,   #000 0px 0px 1px,   #000 0px 0px 1px,
		             #000 0px 0px 1px,   #000 0px 0px 1px,   #000 0px 0px 1px;
		-webkit-font-smoothing: antialiased;
	}


	.cornerKnapper{
		/*fixer at knappen er stuck i venstre hjørne*/
		position: fixed;
		width: 64px; /*størrelse*/
		height: 64px;
		z-index: 1; /*same layer som epWeelFelt*/
		
		background-size: 100%;
		border: 0; /*remover basic button look*/
		border-radius: 50%; /* rounder corners så dei passer til den runde knappen */
		opacity: 0.5; /* gjemmer knappen litt */
		transition: 0.4s; /*gir animation*/
	}
	.cornerKnapper:focus { /*remover blå box som kommer når knappen blir trykka*/
		outline: none;
	}
	.cornerKnapper:hover { /* gjer knappen synlig når hovera over */
		opacity: 1;
	}

	#buttonBackToTop { /*spesifikt for knappen*/
		bottom: 10px; /*definerer position*/
		right: 10px;
		
		background-image: url(icons/backtotop256x.png); /* setter bilde på knappen */
	}
	#buttonJumpToWeek { /*spesifikt for knappen*/
		bottom: 10px; /*definerer position*/
		right: 80px;
		
		background-image: url(icons/jumptoweek256x.png); /* setter bilde på knappen */
	}
	#buttonCrunchy { /*spesifikt for knappen*/
		bottom: 10px; /*definerer position*/
		right: 150px;
		
		background-image: url(icons/crunchy256x.png); /* setter bilde på knappen */
	}
	#buttonMAL { /*spesifikt for knappen*/
		bottom: 10px; /*definerer position*/
		right: 220px;
		
		background-image: url(icons/MAL256x.png); /* setter bilde på knappen */
	}
	#buttonGamleVeker { /*spesifikt for knappen*/
		bottom: 10px; /*definerer position*/
		right: 290px;
		
		background-image: url(icons/gamleveker256x.png); /* setter bilde på knappen */
	}

</style>
</head>
<body>
	<div id="wallpaperDiv"><img id="wallpaperImage" src=""></div> <!-- wallpaper som ligger bak -->
	<button id="buttonBackToTop" class="cornerKnapper" title="Hopp til toppen"></button>
	<button id="buttonJumpToWeek" class="cornerKnapper" title="Hopp til veka me er i"></button>
	<button id="buttonCrunchy" class="cornerKnapper" title="Åpne One Piece på Crunchyroll i ny tab"></button>
	<button id="buttonMAL" class="cornerKnapper" title="Åpne One Piece på MAL i ny tab"></button>
	<button id="buttonGamleVeker" class="cornerKnapper" title="Toggle vis gamle veker"></button>
	<div id="headerBildeOgTextFelt">
		<div class="headerBoxes">
			<img class="iconsClass" src="character pngs/relative/luffy.png" height="150px" style="padding-top: 3px; padding-right: 10px; padding-left: 80px;">
			<img class="iconsClass" src="character pngs/relative/zoro.png" height="150px" style="padding-top: 3px; padding-right: 20px;">
		</div>
		<div class="headerBoxes">
			<img class="iconsClass" src="icons/logo.png" height="80px" style="padding-top: 15px;">
			<br>
			<!-- keeper fortsatt teksten her, så den viser fra starten av, og gjør at det ser ut som teksten blir med videre ned -->
			<p>Scroll nedover for mer, 
			<br>
			Trykk CTRL + F og skriv inn veketal for å hoppe.</p>
		</div>
		<div class="headerBoxes">
			<img class="iconsClass" src="character pngs/relative/nami.png" height="150px" style="padding-top: 3px; padding-left: 20px;">
			<img class="iconsClass" src="character pngs/relative/sanji.png" height="150px" style="padding-top: 3px; padding-left: 0px;">
			<img class="iconsClass" src="character pngs/relative/usopp.png" height="150px" style="padding-top: 3px; padding-left: 0px;">
		</div>
	</div>
	<div id="headerTextStaysAtTop">
		<img class="iconsClass" src="icons/logo.png" height="60px" style="padding-top: 6px;">
	</div>
	<table id="epsOgWeekTabell">
		<tr><th>Veke</th> <th>Eps</th></tr>
	</table>

<script type="text/javascript">
	//henter tabellen
	var epsOgWeekTabell = document.getElementById("epsOgWeekTabell");
	//henter knapper
	var buttonBackToTop = document.getElementById("buttonBackToTop");
	var buttonJumpToWeek = document.getElementById("buttonJumpToWeek");
	var buttonMAL = document.getElementById("buttonMAL");
	var buttonCrunchy = document.getElementById("buttonCrunchy");
	var buttonGamleVeker = document.getElementById("buttonGamleVeker");


//CODEN FOR UTREGNING AV EPS
	//definerer globale variabler
	var epNr = 0;
	var ukeNr = 10; //begynte på uke 10
	var aarNr = 2020;

	//skriver ut en table row når bedt om det, med unik ID
	function utskrift(){
		epsOgWeekTabell.innerHTML += `<tr id="u${ukeNr}_${aarNr}"> <td id="${ukeNr}"><b>${ukeNr}</b> (${aarNr})</td> <td id="${aarNr}"><b>${epNr}</b></td> </tr>`; //nb, epsNr har aarNr fordi trenger å hente det ut lengre nere aleine
	}

	//såg 5ep/week første 2 veker, så adder det her
	for(i=0; i<(10/5); i++ ){ // (eps seen) / (eps/week) = 2 weeks
		epNr += 5;
		ukeNr += 1;
		utskrift();
	}
	
	//calculater videre med 7eps/week
	for(i=0; i<(1500/7); i++) { //capper 1500 eps total, delt på eps/week.
		epNr += 7; //7 eps
		ukeNr++; //på 1 week

		if (aarNr == 2020) { //for spesialtilfelle 2020 der det er 53 uker.
			if(ukeNr != 53) {
				utskrift(); //skriver ut vanlige veker i 2020
			}
			if (ukeNr === 53) {
				utskrift(); //skriver ut 53ende veke
				aarNr++; //skifter til neste år, så den vil gå til elsen i neste loop.
				ukeNr = 0; //resetter veka til 0 (fordi den adder på 1 i starten).
			}
		}
		else { //for åra etter 2020 (blir ikkje fleire 53 veker-år før me er done trur eg)
			if (ukeNr === 53) { //skifter til neste år
				aarNr++
				ukeNr = 1;
			}
			utskrift();
		}
	}


//FLEXIBLE, SKIFTER ETTER DEVICENS WIDTH OG HEIGHT
	
	//henter wallpaper div og bilde
	var wallpaperDiv = document.getElementById("wallpaperDiv");
	var wallpaperImage = document.getElementById("wallpaperImage");

	function UpdateForResize(){
		//resizer diven for wallpaper
		wallpaperDiv.style.width = window.innerWidth + "px";
		wallpaperDiv.style.height = window.innerHeight + "px";
		//resizer sjølve wallpaper bildet
		wallpaperImage.style.width = window.innerWidth + "px";
		wallpaperImage.style.height = window.innerHeight + "px";

		//sjekker for phone
		if(window.innerWidth < window.innerHeight) { //phone har mindre bredde enn høgde
			epsOgWeekTabell.style.fontSize = "40px"; //update font
			//tilpasser button til phone
			buttonBackToTop.style.width = "128px";
			buttonBackToTop.style.height = "128px";
			buttonBackToTop.style.bottom = "20px";
			buttonBackToTop.style.right = "20px";
			//tilpasser jumpToWeek til phone
			buttonJumpToWeek.style.width = "128px";
			buttonJumpToWeek.style.height = "128px";
			buttonJumpToWeek.style.bottom = "158px";
			buttonJumpToWeek.style.right = "20px";
			//tilpasser Cruncy til phone
			buttonCrunchy.style.width = "128px";
			buttonCrunchy.style.height = "128px";
			buttonCrunchy.style.bottom = "296px";
			buttonCrunchy.style.right = "20px";
			//tilpasser MAL til phone
			buttonMAL.style.width = "128px";
			buttonMAL.style.height = "128px";
			buttonMAL.style.bottom = "434px";
			buttonMAL.style.right = "20px";
			//tilpasser GamleVeker til phone
			buttonGamleVeker.style.width = "128px";
			buttonGamleVeker.style.height = "128px";
			buttonGamleVeker.style.bottom = "572px";
			buttonGamleVeker.style.right = "20px";
		}
		else {
			epsOgWeekTabell.style.fontSize = "16px";//update font
			//tilpasser button til pc
			buttonBackToTop.style.width = "64px";
			buttonBackToTop.style.height = "64px";
			buttonBackToTop.style.bottom = "10px";
			buttonBackToTop.style.right = "10px";
			//tilpasser jumpToWeek til PC
			buttonJumpToWeek.style.width = "64px";
			buttonJumpToWeek.style.height = "64px";
			buttonJumpToWeek.style.bottom = "10px";
			buttonJumpToWeek.style.right = "80px";
			//tilpasser cruncy til PC
			buttonCrunchy.style.width = "64px";
			buttonCrunchy.style.height = "64px";
			buttonCrunchy.style.bottom = "10px";
			buttonCrunchy.style.right = "150px";
			//tilpasser MAL til PC
			buttonMAL.style.width = "64px";
			buttonMAL.style.height = "64px";
			buttonMAL.style.bottom = "10px";
			buttonMAL.style.right = "220px";
			//tilpasser GamleVeker til PC
			buttonGamleVeker.style.width = "64px";
			buttonGamleVeker.style.height = "64px";
			buttonGamleVeker.style.bottom = "10px";
			buttonGamleVeker.style.right = "290px";
		}

	}
	UpdateForResize(); //kjører det en gang på load
	window.onresize = UpdateForResize; //updater om vinduet endres

//PICK RANDOM WALLPAPER
	//array som holder navn på alle wallpapers
	var wallpaperArray = ["going merry.png","baratie fanart.jpg","darker blue sea and sky.jpg","going merry cg.jpg","going merry simple.jpg","luffy and gang.jpg","sea and going merry moving.gif","sea and sky 2.jpg","sea and sky.jpg","sea and sky.jpg","sea moving.webp","luffy and gang 2.jpg","going merry speed.jpg","going merry dark sky.jpg"];
	//rng, picker random tall fra 0 til array length-1 (siden flooring).
	var randomTallForWallpaperArray = Math.floor(Math.random()*wallpaperArray.length);
	//skifter bildet her
	wallpaperImage.src = "wallpapers/" + wallpaperArray[randomTallForWallpaperArray]; 


//REKNE UT VEKE FRÅ DATOEN DEN FÅR FRA PC
	//henta fra: 
	//https://stackoverflow.com/questions/6117814/get-week-of-year-in-javascript-like-in-php
	function getWeekNumber(d) {
	    // Copy date so don't modify original
	    d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()));
	    // Set to nearest Thursday: current date + 4 - current day number
	    // Make Sunday's day number 7
	    d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay()||7));
	    // Get first day of year
	    var yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
	    // Calculate full weeks to nearest Thursday
	    var weekNo = Math.ceil(( ( (d - yearStart) / 86400000) + 1)/7);
	    // Return array of year and week number
	    return [d.getUTCFullYear(), weekNo];
	}

	var result = getWeekNumber(new Date());
	

	//henter veka(1) og året(0) ut fra koden over her:
	var vekaMeErI = `u${result[1]}_${result[0]}`;
	var vekaMeErIOffset = `u${result[1]-5}_${result[0]}`; //velger fem veker før, så vekaMeErI blir meir mot midten i høgda

	//highlighter veka me er i
	document.getElementById(vekaMeErI).style.backgroundColor = "rgba(229, 170, 42, 0.5)";

	//denne messen er fordi :hover i CSS ikkje virker når du har endra background color i js.
	document.getElementById(vekaMeErI).onmouseover = function(){
		document.getElementById(vekaMeErI).style.backgroundColor = "white";
	}
	document.getElementById(vekaMeErI).onmouseout = function(){
		document.getElementById(vekaMeErI).style.backgroundColor = "rgba(229, 170, 42, 0.5)";
	}

//KODE SOM HIDER VEKENE FØR OFFSETTET
	//travarserer table rows
	for(i=1; i<epsOgWeekTabell.rows.length; i++){ //tar i=1 for å hoppe over første row som er headers
		if(Number(epsOgWeekTabell.rows[i].cells[0].id) < result[1]-5 && Number(epsOgWeekTabell.rows[i].cells[1].id) <= result[0]) { //viss tabellrekka si veke er 5 mindre enn currentWeek, og er i samme året, eller åra før
			epsOgWeekTabell.rows[i].style.display = "none"; //gjemmer rekka

		}
	}
//KNAPP SOM TOGGLER OM DEI GAMLE VEKENE SKAL VISES ELLER IKKJE
	var viserGamleVeker = false;
	buttonGamleVeker.onclick= function(){
		if(!viserGamleVeker){ //viss dei gamle vekene ikkje viser, vis dei
			for(i=1; i<epsOgWeekTabell.rows.length; i++){ //tar i=1 for å hoppe over første row som er headers
				if(Number(epsOgWeekTabell.rows[i].cells[0].id) < result[1]-5 && Number(epsOgWeekTabell.rows[i].cells[1].id) <= result[0]) { //viss tabellrekka si veke er 5 mindre enn currentWeek, og er i samme året, eller åra før
					epsOgWeekTabell.rows[i].style.display = "table-row"; //viser rekka
				}
			}
			viserGamleVeker = true; //setter at nå viser en de gamle vekene
		}	
		else if(viserGamleVeker){ //viss gamle veker vises, gjem dei
			for(i=1; i<epsOgWeekTabell.rows.length; i++){ //tar i=1 for å hoppe over første row som er headers
				if(Number(epsOgWeekTabell.rows[i].cells[0].id) < result[1]-5 && Number(epsOgWeekTabell.rows[i].cells[1].id) <= result[0]) { //viss tabellrekka si veke er 5 mindre enn currentWeek, og er i samme året, eller åra før
					epsOgWeekTabell.rows[i].style.display = "none"; //gjemmer rekka

				}
			}	
			viserGamleVeker = false; //setter at nå vises ikkje dei gamle vekene
		}
	}


//KNAPP FOR JUMP TE VEKE
	buttonJumpToWeek.onclick = function() { //onclick
		//må putte vekaMeErI i getElementById for at den skal gjelde teksten den holder som en Id den skal finne
		document.getElementById(vekaMeErIOffset).scrollIntoView({behavior: 'smooth'}); //scroll til veka me er i (egentlig nogen veker før, for at veka me er i er meir mot midten)
		document.getElementById(vekaMeErI).style.backgroundColor = "rgba(229, 170, 42, 1)"; //highlight feltet

		setTimeout(function(){document.getElementById(vekaMeErI).style.backgroundColor = "rgba(229, 170, 42, 0.5)";},3000); //tar vekk highlight etter 3 s.
	}

//KNAPP TIL TOPPEN
	buttonBackToTop.onclick = function() {
		headerBildeOgTextFelt.scrollIntoView({behavior: "smooth"}); //scrollIntoView hopper til id-en.
	}
//KNAPPER CR OG MAL
	buttonCrunchy.onclick = function() {
		window.open("https://www.crunchyroll.com/one-piece", "_blank");		
	}
	buttonMAL.onclick = function() {
		window.open("https://myanimelist.net/anime/21/One_Piece", "_blank");
	}

</script>
</body>
</html>
